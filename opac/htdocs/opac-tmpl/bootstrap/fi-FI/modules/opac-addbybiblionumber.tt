[% USE raw %]
[% PROCESS 'i18n.inc' %]
[% PROCESS 'html_helpers.inc' %]
[% INCLUDE 'doc-head-open.inc' %]
<title>[% FILTER collapse %]
 [% t("Add to your list") | html %] &rsaquo;
 [% PROCESS 'library_name_title' %]
[% END %]</title>
[% INCLUDE 'doc-head-close.inc' %]
[% BLOCK cssinclude %][% END %]
</head>
[% INCLUDE 'bodytag.inc' bodyid='addtolist' bodyclass='popup' %]
 <div class="main">
 <div class="container-fluid">
 <div class="row">
 <div class="col order-first order-md-first order-lg-2">
 <div id="useraddbybiblionumber" class="maincontent">
 [% IF ( authorized ) %]
 [% UNLESS ( newshelf ) %]
 [% IF ( multiple ) %]
 <h1>Lisää [% total | html %] nimekettä [% IF ( singleshelf ) %]<em>[% shelfname | html %]</em>: [% ELSE %]<span>lista:</span>[% END %]</h1>
 [% ELSE %]
 <h1>Lisää tähän [% IF ( singleshelf ) %]<em>[% shelfname | html %]</em>[% ELSE %]<span>lista:</span>[% END %]</h1>
 [% END %]
 <ul>
 [% FOREACH biblio IN biblios %]
 <li>[% INCLUDE 'biblio-title.inc' %]
 [% IF ( biblio.author ) %]<span class="author"> [% biblio.author | html %][% END %]
 </li>
 [% END %]
 </ul>
 [% IF private_shelves.count or public_shelves.count or private_shelves_shared_with_me.count %]
 <form name="f1" action="/cgi-bin/koha/opac-addbybiblionumber.pl" method="post">
 [% INCLUDE 'csrf-token.inc' %]
 <fieldset>
 <legend>Valitse lista</legend>
 <label for="shelfnumber">Lisää listalle:</label> <select name="shelfnumber" id="shelfnumber">
 [% IF private_shelves.count %]<optgroup label="Yksityiset listat">
 [% FOREACH private_shelf IN private_shelves %]
 <option value="[% private_shelf.shelfnumber | html %]">[% private_shelf.shelfname | html %]</option>
 [% END %]
 </optgroup>[% END %]
 [% IF private_shelves_shared_with_me.count %]<optgroup label="Minulle jaetut yksityiset listat">
 [% FOREACH private_shelf IN private_shelves_shared_with_me %]
 <option value="[% private_shelf.shelfnumber | html %]">[% private_shelf.shelfname | html %]</option>
 [% END %]
 </optgroup>[% END %]
 [% IF public_shelves.count %]<optgroup label="Julkiset listat">
 [% FOREACH public_shelf IN public_shelves %]
 <option value="[% public_shelf.shelfnumber | html %]">[% public_shelf.shelfname | html %]</option>
 [% END %]
 </optgroup>[% END %]
 </select>
 [% FOREACH biblio IN biblios %]
 <input type="hidden" name="biblionumber" value="[% biblio.biblionumber | html %]" />
 [% END %]
 <input type="hidden" name="op" value="cud-modifyshelfcontents" />
 </fieldset>
 <fieldset class="action">
 <input class="btn btn-primary" type="submit" value="Tallenna" />
 <a class="close cancel" href="#">Peruuta</a>
 </fieldset>
 </form>
 <p>...tai...</p>
 [% ELSE %]
 [% IF ( singleshelf ) %]
 <form name="f1" action="/cgi-bin/koha/opac-addbybiblionumber.pl" method="post">
 [% INCLUDE 'csrf-token.inc' %]
 [% FOREACH biblio IN biblios %]
 <input type="hidden" name="biblionumber" value="[% biblio.biblionumber | html %]">
 [% END %]
 <input type="hidden" name="shelfnumber" value="[% shelfnumber | html %]" />
 <input type="hidden" name="op" value="cud-modifyshelfcontents" /></fieldset>
 <fieldset class="action">
 <input class="btn btn-primary" type="submit" value="Tallenna" />
 <a class="close cancel" href="#">Peruuta</a>
 </fieldset>
 </form>
 [% END %]
 [% END # IF / existingshelves %]
 [% END # / UNLESS newshelf %]

 [% UNLESS ( singleshelf ) %]
 <form name="f2" method="post" action="/cgi-bin/koha/opac-addbybiblionumber.pl">
 [% INCLUDE 'csrf-token.inc' %]
 <fieldset>
 <legend>Lisää uudelle listalle:</legend>
 <label for="newvirtualshelf">Listan nimi:</label>
 <input type="text" name="newvirtualshelf" id="newvirtualshelf" size="40" />
 <label for="category">Luokka:</label>
 <select name="public" id="public">
 <option value="0">Yksityinen</option>
 [% IF (OpacAllowPublicListCreation) %]
 <option value="1">Julkinen</option>
 [% END %]
 </select>
 </fieldset>
 [% FOREACH biblio IN biblios %]
 <input type="hidden" name="biblionumber" value="[% biblio.biblionumber | html %]" />
 [% END %]
 <fieldset class="action">
 <input type="hidden" name="op" value="cud-add" />
 <input type="hidden" name="sortfield" value="title" />
 <input class="btn btn-primary" type="submit" value="Tallenna" />
 <a class="close cancel" href="#">Peruuta</a>
 </fieldset>
 </form>
 [% END # / UNLESS singleshelf %]
 [% ELSE %]
 <p>
 [% IF (errcode==1) %]
 <span>Uuden listan luominen ei onnistunut. Tarkista, onko nimi jo käytössä.</span>
 [% ELSE %]
 <span>Et voi lisätä niteitä tähän listaan.</span>
 [% END %]
 </p>
 [% END # IF authorized %]
 <p><a href="#" class="close">Sulje tämä ikkuna.</a></p>
 </div> <!-- / #useraddbybiblionumber -->
 </div> <!-- / .span12 -->
 </div> <!-- / .row -->
 </div> <!-- / .container-fluid -->
 </div> <!-- / .main -->

[% INCLUDE 'opac-bottom.inc' is_popup=1 %]
[% BLOCK jsinclude %]
<script>
         $(document).ready(function() {
            [% IF WINDOW_PARENT_RELOAD %]
                opener.location.reload();
            [% END %]
            [% IF WINDOW_CLOSE %]
                window.close();
            [% END %]
        });
</script>
[% END %]
