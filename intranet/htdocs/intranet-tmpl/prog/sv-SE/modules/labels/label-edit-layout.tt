[% USE raw %]
[% USE Koha %]
[% PROCESS 'i18n.inc' %]
[% SET footerjs = 1 %]
[%- BLOCK translate_label_types -%]
 [%-  SWITCH type -%]
 [%- CASE 'BIB' -%]<span> Endast bibliografiska data skrivs ut</span>
 [%- CASE 'BARBIB'-%]<span> Streckkod föregår bibliografiska data</span>
 [%- CASE 'BIBBAR'-%]<span> Bibliografiska data föregår streckkod</span>
 [%- CASE 'ALT' -%]<span> Streckkod och bibliografiska data skrivs ut på växlande etiketter</span>
 [%- CASE 'BAR' -%]<span> Endast streckkoden skrivs ut</span>
 [%- END -%]
[%- END -%]
 [% INCLUDE 'doc-head-open.inc' %]
 <title>[% FILTER collapse %]
 [% IF( layout_id ) %]
 [% tx("Edit label layout {layout_id}", { layout_id = layout_id }) | html %]
 [% ELSE %]
 [% t("New label layout") | html %]
 [% END %] &rsaquo;
 [% t("Layouts") | html %] &rsaquo;
 [% t("Label creator") | html %] &rsaquo;
 [% t("Cataloging") | html %] &rsaquo;
 [% t("Koha") | html %]
 [% END %]</title>
 [% INCLUDE 'doc-head-close.inc' %]
</head>

[% BLOCK translate_justification_types %]
[%  SWITCH type %]
[%   CASE 'L' %]<span>Vänster</span>
[%   CASE 'C' %]<span>Centrera</span>
[%   CASE 'R' %]<span>Höger</span>
[%  END %]
[% END %]
<body id="labels_label-edit-layout" class="tools labels">
 [% WRAPPER 'header.inc' %]
 [% INCLUDE 'cat-search.inc' %]
[% END %]

[% WRAPPER 'sub-header.inc' %]
 [% WRAPPER breadcrumbs %]
 [% WRAPPER breadcrumb_item %]
 <a href="/cgi-bin/koha/cataloguing/cataloging-home.pl">Katalogisering</a>
 [% END %]
 [% WRAPPER breadcrumb_item %]
 <a href="/cgi-bin/koha/labels/label-home.pl">Etikettverktyg</a>
 [% END %]
 [% WRAPPER breadcrumb_item %]
 <a href="/cgi-bin/koha/labels/label-manage.pl?label_element=layout">Layouter</a>
 [% END %]
 [% WRAPPER breadcrumb_item bc_active= 1 %]
 [% IF ( layout_id ) %]
 <span>Redigera etikettmall [% layout_id | html %]</span>
 [% ELSE %]
 <span>Ny etikettlayout</span>
 [% END %]
 [% END %]
 [% END #/ WRAPPER breadcrumbs %]
[% END #/ WRAPPER sub-header.inc %]

 <div class="main container-fluid">
 <div class="row">
 <div class="col-md-10 order-md-2 order-sm-1">
 <main>
 [% INCLUDE 'messages.inc' %]

 [% INCLUDE 'labels-toolbar.inc' %]

 [% IF ( layout_id ) %]
 <h1>Redigera etikettmall [% layout_id | html %]</h1>
 [% ELSE %]
 <h1>Ny etikettlayout</h1>
 [% END %]

 <form name="input" action="/cgi-bin/koha/labels/label-edit-layout.pl" method="post">
 <fieldset class="rows">
 <ol>
 <li>
 <label for="layout_name">Layoutnamn: </label>
 <input type="text" name="layout_name" id="layout_name" size="20" value="[% layout_name | html %]" />
 </li>
 <li>
 <label for="barcode_type">Välj streckkodstyp (kodformat): </label>
 <select name="barcode_type" id="barcode_type">
 [% FOREACH barcode_type IN barcode_types %]
 [% IF ( barcode_type.selected ) %]
 <option value="[% barcode_type.type | html %]" selected="selected">[% barcode_type.name | html %]</option>
 [% ELSE %]
 <option value="[% barcode_type.type | html %]">[% barcode_type.name | html %]</option>
 [% END %]
 [% END %]
 </select>
 </li>
 <li>
 <label for="printing_type">Välj layouttyp: </label>
 <select name="printing_type" id="printing_type">
 [% FOREACH label_type IN label_types %]
 [% IF ( label_type.selected ) %]
 <option value="[% label_type.type | html %]" selected="selected">[% PROCESS translate_label_types type=label_type.type %]</option>
 [% ELSE %]
 <option value="[% label_type.type | html %]">[% PROCESS translate_label_types type=label_type.type %]</option>
 [% END %]
 [% END %]
 </select>
 </li>
 <li>
 <fieldset>
 <legend>Bibliografiska data att skriva ut</legend>
 <ol>
 <li class="radio">[% IF ( layout_string ) %]
 <input type="radio" name="layout_choice" id="layout_choice_order" value="layout_table" checked="checked" /><label for="layout_choice_order">Välj ordning för textfält som skrivs ut</label>
 [% ELSE %]
 <input type="radio" name="layout_choice" id="layout_choice_order" value="layout_table" /><label for="layout_choice_order">Välj ordning för textfält som skrivs ut</label>
 [% END %]
 <div id="layout_table">
 <p>
 [% FOREACH text_field IN fields %]
 <select name="[% text_field.field_name | html %]" id="[% text_field.field_name |url %]">
 <option value=""></option>
 [% FOREACH orde IN [1..field_count] %]
 [% IF ( orde == text_field.order ) %]
 <option value="[% orde | html %]" selected="1">[% orde | html %]</option>
 [% ELSE %]
 <option value="[% orde | html %]">[% orde | html %]</option>
 [% END %]
 [% END %]
 </select>&nbsp;<label for="[% text_field.field_name |url %]">[% text_field.field_label | html %]</label>

 &nbsp;&nbsp;

 [% END %]
 </p>
 </div>
 </li>
 [% UNLESS ( layout_string ) %]
 <li class="radio"><input type="radio" id="layout_choice_list" name="layout_choice" value="layout_string" checked="checked" /> <label for="layout_choice_list">Listfält</label></li>
 [% ELSE %]
 <li class="radio"><input type="radio" id="layout_choice_list" name="layout_choice" value="layout_string" /> <label for="layout_choice_list">Listfält</label></li>
 [% END %]
 <li> <fieldset id="layout_string" class="brief">
 <label for="format_string">Datafält</label>
 <input type="text" name="format_string" id="format_string" size="80" value="[% format_string | html %]" />
 <div class="hint">
 <p>Ange en kommaseparerad lista med fält att skriva ut. Du kan ta med alla <em>Koha-fält</em> MARC-delfält.</p>
 <p>Se online-hjälp för avancerade alternativ</p>
 <p>exempel: streckkod, exemplarhyllsignum, titel, "050a 050b", 300a </p>
 <p>Fält homebranch_description, holdingbranch_description, ccode_description, location_description och permanent_location_description visar beskrivning istället för kod.</p>
 </div>
 </fieldset></li>
 </ol>
 </fieldset>
 </li>
 <li>
 <label for="guidebox">Rita guiderutor: </label>
 [% IF ( guidebox ) %]
 <input type="checkbox" name="guidebox" id="guidebox" value="1"  checked="checked" />
 [% ELSE %]
 <input type="checkbox" name="guidebox" id="guidebox" value="1" />
 [% END %]
 </li>
 <li>
 <label for="callnum_split">Dela upp hyllsignaturer: </label>
 [% IF ( callnum_split ) %]
 <input type="checkbox" name="callnum_split" id="callnum_split" value="1"  checked="checked" />
 [% ELSE %]
 <input type="checkbox" name="callnum_split" id="callnum_split" value="1" />
 [% END %]
 </li>
 <li>
 <label for="text_justify">Textjustering: </label>
 <select name="text_justify" id="text_justify">
 [% FOREACH text_justification_type IN text_justification_types %]
 [% IF ( text_justification_type.selected ) %]
 <option value="[% text_justification_type.type | html %]" selected="selected">[% PROCESS translate_justification_types type=text_justification_type.type %]</option>
 [% ELSE %]
 <option value="[% text_justification_type.type | html %]">[% PROCESS translate_justification_types type=text_justification_type.type %]</option>
 [% END %]
 [% END %]
 </select>
 </li>
 <li>
 <label for="font">Teckensnitt: </label>
 <select name="font" id="font">
 [% FOREACH font_type IN font_types %]
 [% IF ( font_type.selected ) %]
 <option value="[% font_type.type | html %]" selected="selected">[% font_type.name | html %]</option>
 [% ELSE %]
 <option value="[% font_type.type | html %]">[% font_type.name | html %]</option>
 [% END %]
 [% END %]
 </select>
 </li>
 <li>
 <label for="font_size">Teckensnittsstorlek: </label>
 <input type="text" name="font_size" id="font_size" size="2" value="[% font_size | html %]" />
 </li>
 <li>
 <label for="scale_width">Streckkodsbredd: </label>
 <input type="text" name="scale_width" id="scale_width" size="2" value="[% scale_width | html %]" />
 </li>
 <li>
 <label for="scale_height">Streckkodshöjd: </label>
 <input type="text" name="scale_height" id="scale_height" size="2" value="[% scale_height | html %]" />
 </li>
 <li>
 <label for="oblique_title">Snedställd titel: </label>
 [% IF ( oblique_title ) %]
 <input type="checkbox" name="oblique_title" id="oblique_title" value="1"  checked="checked" />
 [% ELSE %]
 <input type="checkbox" name="oblique_title" id="oblique_title" value="1" />
 [% END %]
 </li>
 </ol>
 </fieldset>
 <fieldset class="action">
 [% INCLUDE 'csrf-token.inc' %] 
 <input type="hidden" name="op" value="cud-save" />
 <input type="hidden" name="layout_id" value="[% layout_id | html %]" />
 <input class="btn btn-primary" type="submit" value="Spara" />
 <a class="cancel" href="/cgi-bin/koha/labels/label-manage.pl?label_element=layout">Avbryt</a>
 </fieldset>
 </form>
 </main>
 </div> <!-- /.col-md-10.order-md-2 -->

 <div class="col-md-2 order-sm-2 order-md-1">
 <aside>
 [% INCLUDE 'cat-menu.inc' %]
 </aside>
 </div> <!-- /.col-md-2.order-md-1 -->
 </div> <!-- /.row -->

[% MACRO jsinclude BLOCK %]
 <script>
        $(document).ready(function() {
            $('#navmenulist a[href$="/cgi-bin/koha/labels/label-home.pl"]').addClass("current");
            $("input[name='layout_choice']").change( function() { layout_method() } );
            layout_method();
            $("#font").on("change",function(){
                 checkOblique();
            });
        });
        function layout_method() {
            if( $("input[name='layout_choice']:checked").val() == 'layout_string' ) {
                $('#layout_table').hide();
                $('#layout_string').show();
            } else {
                $('#layout_table').show();
                $('#layout_string').hide();
            }
        }
        function checkOblique() {
            var font = document.getElementById("font");
            var selectedfont = font.options[font.selectedIndex].value;
            if ( selectedfont.match("I$") || selectedfont.match("O$") ) {
                document.getElementById("oblique_title").disabled = true;
            } else {
                document.getElementById("oblique_title").disabled = false;
            }
        }
    </script>
[% END %]

[% INCLUDE 'intranet-bottom.inc' %]
